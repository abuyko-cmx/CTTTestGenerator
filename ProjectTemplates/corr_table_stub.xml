<?xml version="1.0" encoding="UTF-8"?>

<!--Generated by CTT Stubs Editor 12.01.18 12:13-->
<stubMQ xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ctt.cinimex.ru/stubMQ.xsd" queueIn="ESB_2_TC_ADAPTER_QUEUE" queueOut="ROUTERMODULE_INPUT_QUEUE" lookupTimeout="1000" name="corr_table_stub" language="groovy" theadPoolSize="7">
  <connectionPool timeout="3600000" maxConnections="115" maxUnusedConnections="30"/>
  <queueManagers>
    <queueManager name="QM2" host="rshb-08.vm.cmx.ru" channel="SYSTEM.DEF.SVRCONN" readEncoding="UTF-8" writeEncoding="UTF-8" user="" password="" port="1415" ccsid="1208">
      <queue name="ROUTERMODULE_INPUT_QUEUE" objName="ROUTERMODULE_INPUT_QUEUE"/>
      <queue name="ESB_2_TC_ADAPTER_QUEUE_104" objName="ESB_2_TC_ADAPTER_QUEUE"/>
    </queueManager>
  </queueManagers>
  <logConfig level="ALL" writeMessages="true" memoryStore="false"/>
  <global name="global">
    <request>
      <content><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<op:operation xmlns:op="http://EsbInternalOnewayInterface.rshb.cinimex.ru">
	<input xmlns:msg="http://message.kfd.rshb.ru" xmlns:hd="http://messageheader.kfd.rshb.ru" xmlns:mb="http://messagebody.kfd.rshb.ru" xmlns:ohd="http://objectheader.kfd.rshb.ru">
		<msg:MessageHeader>
			<hd:MessageId>#{inMessageId}</hd:MessageId>
			<hd:CorrelationId>inCorrelationId</hd:CorrelationId>
			<hd:Priority>#{inPriority}</hd:Priority>
			<hd:DestinationSys>#{inDestinationSys}</hd:DestinationSys>
			<hd:ToBranch>#{inToBranch}</hd:ToBranch>
			<hd:SourceSys>#{inSourceSys}</hd:SourceSys>
			<hd:FromBranch>#{inFromBranch}</hd:FromBranch>
			<hd:InteractionType>#{inInteractionType}</hd:InteractionType>
			<hd:Status>#{inStatus}</hd:Status>
			<hd:ReceiveDateTime>#{inReceiveDateTime}</hd:ReceiveDateTime>
			<hd:TimeToLive>#{inTimeToLive}</hd:TimeToLive>
			<hd:Extension>
				<hd:name>JMSMessageID</hd:name>
				<hd:value>#{inJMSMessageID}</hd:value>
			</hd:Extension>
			<hd:Extension>
				<hd:name>JMSMessageGUID</hd:name>
				<hd:value>#{inJMSMessageGUID}</hd:value>
			</hd:Extension>
			<hd:Extension>
				<hd:name>Direction</hd:name>
				<hd:value>#{inDirection}</hd:value>
			</hd:Extension>
		</msg:MessageHeader>
		<msg:MessageBody>
			<mb:ObjectHeader>
				<ohd:ObjectID>#{inObjectID}</ohd:ObjectID>
				<ohd:ObjectType>#{inObjectType}</ohd:ObjectType>
			</mb:ObjectHeader>
			<mb:ObjectBody>
				<mb:msgStr>#{inMsgStr}</mb:msgStr>
			</mb:ObjectBody>
		</msg:MessageBody>
	</input>
</op:operation>			]]></content>
    </request>
    <response name="TC_TISH"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<op:operation xmlns:op="http://EsbInternalOnewayInterface.rshb.cinimex.ru">
	<input xmlns:msg="http://message.kfd.rshb.ru" xmlns:hd="http://messageheader.kfd.rshb.ru" xmlns:mb="http://messagebody.kfd.rshb.ru" xmlns:ohd="http://objectheader.kfd.rshb.ru">
		<msg:MessageHeader>
			<hd:MessageId>${outMessageId}</hd:MessageId>
			<hd:CorrelationId>${outCorrelationId}</hd:CorrelationId>
			<hd:Priority>${outPriority}</hd:Priority>
			<hd:DestinationSys>${outDestinationSys}</hd:DestinationSys>
			<hd:ToBranch>${outToBranch}</hd:ToBranch>
			<hd:SourceSys>${outSourceSys}</hd:SourceSys>
			<hd:FromBranch>${outFromBranch}</hd:FromBranch>
			<hd:InteractionType>${outInteractionType}</hd:InteractionType>
			<hd:Status>${outStatus}</hd:Status>
			<hd:ReceiveDateTime>${outReceiveDateTime}</hd:ReceiveDateTime>
			<hd:TimeToLive>${outTimeToLive}</hd:TimeToLive>
			<hd:Extension>
				<hd:name>JMSMessageID</hd:name>
				<hd:value>${outJMSMessageID}</hd:value>
			</hd:Extension>
			<hd:Extension>
				<hd:name>JMSMessageGUID</hd:name>
				<hd:value>${outJMSMessageGUID}</hd:value>
			</hd:Extension>
			<hd:Extension>
				<hd:name>Direction</hd:name>
				<hd:value>${outDirection}</hd:value>
			</hd:Extension>
		</msg:MessageHeader>
		<msg:MessageBody>
			<mb:ObjectHeader>
				<ohd:ObjectID>${outObjectID}</ohd:ObjectID>
				<ohd:ObjectType>${outObjectType}</ohd:ObjectType>
			</mb:ObjectHeader>
			<mb:ObjectBody>
				<mb:msgStr>${outMsgStr}</mb:msgStr>
			</mb:ObjectBody>
		</msg:MessageBody>
	</input>
</op:operation>]]></response>
    <response name="TableOfCorrespondence"><![CDATA[<tbl:Table xmlns:tbl="http://www.rshb.ru/TC/test/resp">
	<tbl:Line>
		<tbl:OperatingDate>13.07.2011</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>BQ</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId>1</tbl:SourceSystemNodeId>
		<tbl:SourceBic>444444444</tbl:SourceBic>
		<tbl:SourceObjectId>1111111</tbl:SourceObjectId>
		<tbl:DestinationSystemId>BQ</tbl:DestinationSystemId>
		<tbl:DestinationBranchId>46</tbl:DestinationBranchId>
		<tbl:DestinationSystemNodeId>2</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8717826387</tbl:DestinationObjectId>
		<tbl:DestinationBic>744444444</tbl:DestinationBic>
		<tbl:ObjectType>Acct</tbl:ObjectType>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13.07.2013</tbl:OperatingDate>
		<tbl:VKIObject>234214</tbl:VKIObject>
		<tbl:SourceSystemId>BQ</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId>2</tbl:SourceSystemNodeId>
		<tbl:SourceObjectId>8717826387</tbl:SourceObjectId>
		<tbl:SourceBic>744444444</tbl:SourceBic>
		<tbl:DestinationSystemId>CFT</tbl:DestinationSystemId>
		<tbl:DestinationBranchId>46</tbl:DestinationBranchId>
		<tbl:DestinationSystemNodeId>6554874</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8717826387</tbl:DestinationObjectId>
		<tbl:DestinationBic>744444444</tbl:DestinationBic>
		<tbl:ObjectType>Acct</tbl:ObjectType>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>16.11.2014</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>CFT</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId>6554874</tbl:SourceSystemNodeId>
		<tbl:SourceObjectId>8717826387</tbl:SourceObjectId>
		<tbl:SourceBic>744444444</tbl:SourceBic>
		<tbl:DestinationSystemId>CFT</tbl:DestinationSystemId>
		<tbl:DestinationBranchId>31</tbl:DestinationBranchId>
		<tbl:DestinationSystemNodeId>2345345</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>2222222222</tbl:DestinationObjectId>
		<tbl:DestinationBic>744444444</tbl:DestinationBic>
		<tbl:ObjectType>Acct</tbl:ObjectType>
	</tbl:Line>
</tbl:Table>]]></response>
    <response name="without_io"><![CDATA[<tbl:Table xmlns:tbl="http://www.rshb.ru/TC/test/resp">
</tbl:Table>]]></response>
    <response name="response_cft"><![CDATA[<tbl:Table xmlns:tbl="http://www.rshb.ru/TC/test/resp">
	<tbl:Line>
		<tbl:OperatingDate>13.07.2011</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>CFT</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>1</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>871781111</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13.07.2013</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>CFT</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>2</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>822222222</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13.07.2015</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>CFT</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>3</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>83333333</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
</tbl:Table>]]></response>
    <response name="response_bq"><![CDATA[<tbl:Table xmlns:tbl="http://www.rshb.ru/TC/test/resp">	
	<tbl:Line>
		<tbl:OperatingDate>13.07.2011</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>BQ</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>1</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8717826381</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13.07.2015</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId>BQ</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>2</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8717826381</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13.07.2013</tbl:OperatingDate>
		<tbl:VKIObject>234214</tbl:VKIObject>
		<tbl:SourceSystemId>BQ</tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>4</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8717826383</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
</tbl:Table>]]></response>
    <response name="without_SourceSystemId"><![CDATA[<tbl:Table xmlns:tbl="http://www.rshb.ru/TC/test/resp">	
	<tbl:Line>
		<tbl:OperatingDate>13-07-2015</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId></tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>1</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8711111111</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
	<tbl:Line>
		<tbl:OperatingDate>13-07-2011</tbl:OperatingDate>
		<tbl:VKIObject/>
		<tbl:SourceSystemId></tbl:SourceSystemId>
		<tbl:SourceBranchId>${sourceBranchId}</tbl:SourceBranchId>
		<tbl:SourceSystemNodeId/>
		<tbl:SourceBic/>
		<tbl:SourceObjectId/>
		<tbl:DestinationSystemId/>
		<tbl:DestinationBranchId/>
		<tbl:DestinationSystemNodeId>2</tbl:DestinationSystemNodeId>
		<tbl:DestinationObjectId>8712222222</tbl:DestinationObjectId>
		<tbl:DestinationBic/>
		<tbl:ObjectType/>
	</tbl:Line>
</tbl:Table>]]></response>
    <script name="response" type="main"><![CDATA[// Получим данные из contextRequest.
def inMessageId       = contextRequest.getRequest().getParam("inMessageId");
def inPriority        = contextRequest.getRequest().getParam("inPriority");
def inDestinationSys  = contextRequest.getRequest().getParam("inDestinationSys");
def inToBranch        = contextRequest.getRequest().getParam("inToBranch");
def inSourceSys       = contextRequest.getRequest().getParam("inSourceSys");
def inFromBranch      = contextRequest.getRequest().getParam("inFromBranch");
def inInteractionType = contextRequest.getRequest().getParam("inInteractionType");
def inStatus          = contextRequest.getRequest().getParam("inStatus");
def inReceiveDateTime = contextRequest.getRequest().getParam("inReceiveDateTime");
def inTimeToLive      = contextRequest.getRequest().getParam("inTimeToLive");
def inJMSMessageID    = contextRequest.getRequest().getParam("inJMSMessageID");
def inJMSMessageGUID  = contextRequest.getRequest().getParam("inJMSMessageGUID");
def inDirection       = contextRequest.getRequest().getParam("inDirection");
def inObjectID        = contextRequest.getRequest().getParam("inObjectID");
def inObjectType      = contextRequest.getRequest().getParam("inObjectType");
def inMsgStr          = contextRequest.getRequest().getParam("inMsgStr");

// Подготовим данные для contextResponse.
def msgResp	= contextResponse.getTemplate("TC_TISH");
msgResp.setParam("outMessageId",       inMessageId);
msgResp.setParam("outCorrelationId",   inMessageId);
msgResp.setParam("outPriority",        inPriority);
msgResp.setParam("outDestinationSys",  inSourceSys);
msgResp.setParam("outToBranch",        inToBranch);
msgResp.setParam("outSourceSys",       inDestinationSys);
msgResp.setParam("outFromBranch",      inFromBranch);
msgResp.setParam("outInteractionType", inInteractionType);
msgResp.setParam("outStatus",          inStatus);
msgResp.setParam("outReceiveDateTime", inReceiveDateTime);
msgResp.setParam("outTimeToLive",      inTimeToLive);
msgResp.setParam("outJMSMessageID",    inJMSMessageID);
msgResp.setParam("outJMSMessageGUID",  inJMSMessageGUID);
msgResp.setParam("outDirection",       "ANSWER");
msgResp.setParam("outObjectID",        inObjectID);
msgResp.setParam("outObjectType",      inObjectType);

String infoObject;
Integer filial = inToBranch as Integer;

if (filial == 1001 || filial == 1002 ||	filial == 1003 || filial == 1007 )
	infoObject = "without_io";

else if(filial == 1004)
	infoObject = "response_cft";

else if(filial == 1005)
	infoObject = "response_bq";

else if(filial == 1012)
	infoObject = "without_SourceSystemId";

else
	infoObject = "TableOfCorrespondence";

//Добавим филиал в corr_table_resp_io
def io_Object = contextResponse.getTemplate(infoObject);
io_Object.setParam("sourceBranchId", inToBranch);

msgResp.setParam("outMsgStr", io_Object.toString(), "ESCAPE");
return msgResp;		]]></script>
    <headers>
      <OutParams>
        <Param name="characterSet">1208</Param>
      </OutParams>
    </headers>
  </global>
</stubMQ>
